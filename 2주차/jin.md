# 3장. 가상 DOM

|  | 실제 DOM | 가상 DOM |
| --- | --- | --- |
| 구성 | 노드 객체 | JS 객체 |

DOM : 문서 객체 모델 (일반적으로 브라우저 런타임의 문서 모델을 의미)

가상 DOM을 먼저 업데이트 하는 이유

⇒ 실제 DOM 업데이트가 다소 느리고 비용이 많이 들기 때문

⇒ 브라우저, 호스트 환경으로부터 자유롭고 다양한 알고리듬에 접근해 빠르고 효율적으로 동작하는 가상 DOM은 실제 페이지를 변경시키지 않기 때문에 훨씬 빠르게 동작 가능 

리액트는 가상 DOM을 사용하여 성능 영향을 최소화

⇒ 가상 DOM 업데이트 시, 이전 버전과 새 버전의 차이점을 식별하여 실제 DOM 업데이트에 필요한 최소한의 변경사항만 선정하고 적용

엘리먼트 선택 방법에 따른 복잡도 차이에 의한 특징

| querySelector | getElementById |
| --- | --- |
| 조회 시간, 복잡도가 가변적이므로(최악의 경우 o(n)) 클래스 이름이 동일한 여러 엘리먼트 선택할 때 사용 시, 적절 | id 속성이 고유하기 때문에 조회 시간이 짧아서 대부분의 경우 효율적 |

---

<실제 DOM의 문제점>

**[성능]**

상황 : offsetWidth 속성 사용

문제 : 브라우저에서 레이아웃을 다시 계산하며 많은 비용 발생 가능

방안 : getBoundingClientRect 메서드 사용하여 레이아웃 읽기 및 쓰기 일괄 처리 ⇒ 리플로 발생 횟수 감소,레이아웃 스래싱 현상 최소화

*레이아웃 스레싱 : 레이아웃 읽고 쓰는 작업 자주 반복될 때, 발생하는 불필요한 레이아웃 재계산 ⇒ 사용자 경험 악화하므로 레이아웃 속성에 전략적 접근 필요

상황 : getBoundingClientRect 메서드 사용

문제 : 리플로 발생 가능

방안 : 브라우저가 레이아웃을 강제로 다시 계산하는 횟수를 최소화하고, 계산할 때는 한 번의 작업으로 필요한 정보를 모두 가져오도록 함 ⇒ **리액트는 이 작업을 가상 DOM을 이용해서 처리**

**[브라우저 간 호환성]**

리액트는 합성 이벤트 시스템으로 해결

*합성 이벤트 객체 : 여러 브라우저에서 일관성을 보장하기 위해 설계된 객체로 브라우저 기본 이벤트를 둘러싼 래퍼 객체 ⇒ 통합 인터페이스 제공, 이벤트 위임, 다양한 기능 개선, 네이티브 이벤트에 접근

---

문서 조각 : DOM 노드를 저장하는 가벼운 컨테이너, 기본 DOM에 영향을 주지 않고 여러 가지 업데이트를 수행할 수 있는 임시 저장소처럼 동작, 업데이트 작업이 완료되면 문서 조각을 DOM에 추가하는 방식으로 리플로, 리페인팅 한번만 발생

장점 : 일괄 업데이트, 메모리 효율성, 중복 렌더링 방지

 **리액트의 가상 DOM은 문서 조각 개념을 더 나은 방식으로 구현한것** 

---

리액트 앨리먼트 : 리액트 애플리케이션의 가장 작은 구성 블록으로 화면에 표시되어야할 내용 설명하는 자바스크립트 객체

- type 속성 : 엘리먼트가 나타내는 컴포넌트 종류, 문자열 > HTML 태그 이름/ 함수 > JSX 반환하는 자바스크립트 함수

- ref : DOM을 직접 조작해야하는 경우 사용

- props : 컴포넌트에 전달된 모든 속성과 프롭 포함 객체

- _owner : 리액트 내부적인 구현을 위해 사용하는 값, 해당 엘리먼트 생성한 컴포넌트 추적용

- _store : 리액트 내부적인 구현을 위해 사용하는 값, 엘리먼트에 대한 추가 데이터 저장
